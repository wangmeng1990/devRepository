<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yinuo.bigdata.system.mapper.CommunicationMapper" >

    <resultMap id="dictionarieMap" type="com.inuol.bigdata.ext.TBigdataCommunicationNode">
        <result property="departmentId" column="departmentName"></result>
        <collection property="children" ofType="com.inuol.bigdata.ext.TBigdataCommunicationNode">
            <id property="id" column="two_id"></id>
            <result property="communicateName" column="communicateName"></result>
            <result property="phone" column="phone"></result>
            <result property="roleId" column="roleId"></result>
        </collection>
    </resultMap>

    <insert id="addCommunicateBatch" >
        insert into t_bigdata_communication (id, communicate_name, phone,
        office_mobile, department_id, role_id,
        sex, birthday, jiguan,
        create_time)
        values
        <foreach collection ="communicationList" item="list" index="index" separator=",">
            (
                #{list.id,jdbcType=BIGINT},
                #{list.communicateName,jdbcType=VARCHAR},
                #{list.phone,jdbcType=VARCHAR},
                #{list.officeMobile,jdbcType=VARCHAR},
                #{list.departmentId,jdbcType=VARCHAR},
                #{list.roleId,jdbcType=VARCHAR},
                #{list.sex,jdbcType=VARCHAR},
                #{list.birthday,jdbcType=VARCHAR},
                #{list.jiguan,jdbcType=VARCHAR},
                #{list.createTime,jdbcType=TIMESTAMP}
            )
        </foreach >


  </insert>

    <select id="appSelectCommunicate" resultMap="dictionarieMap">
        select
        a.department_id one_id,
        a.id two_id,
        b.department_name departmentName,
        a.communicate_name communicateName,
        a.phone phone,
        a.role_id roleId
        FROM t_bigdata_communication a JOIN t_bigdata_department b
        ON a.department_id = b.id
    </select>

</mapper>